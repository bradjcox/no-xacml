<?xml version="1.0" encoding="UTF-8"?>
<Policy
      xmlns="urn:oasis:names:tc:xacml:2.0:policy:schema:os"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="urn:oasis:names:tc:xacml:2.0:policy:schema:os
        access_control-xacml-2.0-policy-schema-os.xsd"
      PolicyId="urn:oasis:names:tc:xacml:2.0:conformance-test:IIC014:policy"
      RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:deny-overrides">
    <Description>
        Policy for Conformance Test IIC014.
        
Special Instructions for Test Case II.C.14

The policy for this test contains a static type error.

If an initial policy with static type errors MAY EVER be
evaluated by the implementation's XACML PDP at the time a Request
is received, then this test MUST be passed.  In this case, the
result MUST be consistent with the supplied IIC003Response.xml
file: it returns a Decision of Indeterminate with a StatusCode
value of "urn:oasis:names:tc:xacml:1.0:status:processing-error".

If the implementation's XACML PDP CAN NEVER attempt to evaluate
an initial policy with static type errors at the time a Request
is received, then the implementation MUST demonstrate that the
policy in IIA004Policy.xml will be rejected by whatever entity is
responsible for validating policy syntax in the system in which
the XACML PDP will be used.  In this case, the supplied Request
and Response files are not relevant and may be ignored.
    </Description>
    <Target/>
    <Rule
          RuleId="urn:oasis:names:tc:xacml:2.0:conformance-test:IIC014:rule"
          Effect="Permit">
        <Description>
            A subject who is at least 5 years older than Bart
            Simpson may read Bart Simpson's medical record.
        </Description>
        <Condition>
<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-greater-than-or-equal">
            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-one-and-only">
                <SubjectAttributeDesignator
                      AttributeId="urn:oasis:names:tc:xacml:2.0:conformance-test:age"
                      DataType="http://www.w3.org/2001/XMLSchema#integer"/>
            </Apply>
            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-add">
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-one-and-only">
                    <EnvironmentAttributeDesignator
                          AttributeId="urn:oasis:names:tc:xacml:2.0:conformance-test:bart-simpson-age"
                          DataType="http://www.w3.org/2001/XMLSchema#integer"/>
                </Apply>
                <AttributeValue
                      DataType="http://www.w3.org/2001/XMLSchema#string">5</AttributeValue>
            </Apply>
        
</Apply></Condition>
    </Rule>
</Policy>
